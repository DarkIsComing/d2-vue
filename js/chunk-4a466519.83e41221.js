(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4a466519","chunk-2d225d9c"],{"0bb4":function(t,e,s){"use strict";s.d(e,"a",(function(){return n})),s.d(e,"b",(function(){return a})),s.d(e,"c",(function(){return o}));var i=s("9bd2");function n(t){return console.log("传入的参数",t),Object(i["a"])({url:"/admin/notice/",method:"get",params:t})}function a(t){return console.log("传入的参数",t),Object(i["a"])({url:"/admin/notice/user/",method:"get",params:t})}function o(t){return console.log("传入的参数",t),Object(i["a"])({url:"/admin/notice/",method:"post",data:t})}},ab12:function(t,e,s){},b912:function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("d2-container",[i("template",{slot:"header"},[i("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.selectButton(0)}}},[t._v("收信息箱")]),i("el-button",{attrs:{type:"success"},on:{click:function(e){return t.selectButton(1)}}},[t._v("发布通知")])],1),t.show_manage?i("div",{attrs:{id:"msg_manage"}},[i("div",{staticClass:"msg_box"},[i("div",{staticClass:"msg_nav"},[i("div",{staticClass:"msg_nav_item",class:{msg_nav_item_active:0==t.menuId},on:{click:function(e){return t.selectMenu(0)}}},[t._v("钱包通知 ")]),i("div",{staticClass:"msg_nav_item",class:{msg_nav_item_active:1==t.menuId},on:{click:function(e){return t.selectMenu(1)}}},[t._v("资源通知 ")]),i("div",{staticClass:"msg_nav_item",class:{msg_nav_item_active:2==t.menuId},on:{click:function(e){return t.selectMenu(2)}}},[t._v("签到通知 ")])]),i("div",{staticClass:"msg_list"},t._l(t.msgList,(function(e,s){return i("div",{key:s,staticClass:"msg_item",on:{click:function(e){return t.select(s)}}},[i("div",{staticClass:"msg_item_top"},[i("div",{staticClass:"msg_top_left"},[i("div",{staticClass:"msg_user_name"},[t._v(t._s(e.use_name))])])]),i("div",{staticClass:"msg_item_content"},[t._v(" "+t._s(e.notes)+" ")]),i("div",{staticClass:"msg_item_bottom"},[i("div",{staticClass:"msg_item_time"},[t._v(t._s(e.create_time))])]),i("div",{staticClass:"msg_del"},[t._v("删除")])])})),0)]),i("div",{staticClass:"msg_return"},[i("div",{staticClass:"msg_return_top"},[i("div",{staticClass:"return_title"},[t._v("您的新的消息，请注意查收")]),i("div",{staticClass:"return_tip"},[t._v("报修、付款、提现通知不用回复哦，如果遇到客户的提现的疑问须尽快回复哦！")])]),i("div",{staticClass:"user_msg"},[i("div",{staticClass:"user_des"},[i("div",{staticClass:"user_msg_head"},[i("div",{staticClass:"user_msg_head_bg"}),i("div",{staticClass:"user_msg_dot"})]),i("div",{staticClass:"user_msg_name"},[t._v(t._s(t.use_name))])]),i("div",{staticClass:"user_msg_content"},[t._v(" "+t._s(t.notes)+" ")]),i("div",{staticClass:"user_msg_time"},[t._v(t._s(t.create_time))])])])]):t._e(),t.show_send?i("div",{attrs:{id:"send_notice"}},[i("div",{staticClass:"msg_box"},[i("div",{staticClass:"msg_list"},t._l(t.sendList,(function(e,s){return i("div",{key:s,staticClass:"msg_item",on:{click:function(e){return t.selectSend(s)}}},[i("div",{staticClass:"msg_item_top"},[i("div",{staticClass:"msg_top_left"},[i("div",{staticClass:"msg_user_name"},[t._v(t._s(e.use_name))])])]),i("div",{staticClass:"msg_item_content"},[t._v(" "+t._s(e.notes)+" ")]),i("div",{staticClass:"msg_item_bottom"},[i("div",{staticClass:"msg_item_time"},[t._v(t._s(e.create_time))])]),i("div",{staticClass:"msg_del"},[t._v("删除")])])})),0)]),i("div",{staticClass:"msg_return"},[i("div",{staticClass:"msg_return_top"},[i("div",{staticClass:"return_title"},[t._v("选择发送对像")]),i("div",{staticClass:"msg_select_text"},[i("el-radio",{attrs:{label:"0"},model:{value:t.radio,callback:function(e){t.radio=e},expression:"radio"}},[t._v("@所有人")])],1),i("div",{staticClass:"msg_select_text"},[i("el-radio",{attrs:{label:"1"},model:{value:t.radio,callback:function(e){t.radio=e},expression:"radio"}},[t._v("@某人")])],1),i("el-autocomplete",{attrs:{"fetch-suggestions":t.querySearchAsync,placeholder:"请输入用户名进行新增"},on:{select:t.handleSelect},model:{value:t.queryOption,callback:function(e){t.queryOption=e},expression:"queryOption"}})],1),i("div",{staticClass:"msg_return_box"},[i("div",{staticClass:"return_box_title"},[i("span",[t._v("发送一则新通知")]),i("div",{staticClass:"toolbar",attrs:{id:"text_area_tool"}})]),i("div",[i("quill-editor",{ref:"quill",attrs:{id:"desc",options:t.editorOption},on:{change:function(e){return t.onEditorChange(e)}},model:{value:t.desc,callback:function(e){t.desc=e},expression:"desc"}})],1)]),i("div",{staticClass:"return_btn"},[i("div",{staticClass:"return_btn_content",on:{click:t.publish}},[i("img",{attrs:{src:s("e5c9")}}),i("span",[t._v("确认发布")])])])])]):t._e()],2)},n=[],a=(s("841c"),s("53ca")),o=s("953d");const c={watcher:{},active:null,on:function(t,e){this.watcher[t]||(this.watcher[t]=e)},emit:function(t,e=1){this.active=this.watcher[t],1===e&&l()}};class r{constructor(t,e={}){this.id=Math.random(),this.quill=t,this.quill.id=this.id,this.config=e,this.file="",this.imgURL="",t.root.addEventListener("paste",this.pasteHandle.bind(this),!1),t.root.addEventListener("drop",this.dropHandle.bind(this),!1),t.root.addEventListener("dropover",(function(t){t.preventDefault()}),!1),this.cursorIndex=0,c.on(this.id,this)}pasteHandle(t){c.emit(this.quill.id,0);let e,s,i,n=t.clipboardData,a=0;if(n){if(e=n.items,!e)return;for(s=e[0],i=n.types||[];a<i.length;a++)if("Files"===i[a]){s=e[a];break}if(s&&"file"===s.kind&&s.type.match(/^image\//i)){this.file=s.getAsFile();let t=this;if(t.config.size&&t.file.size>=1024*t.config.size*1024)return void(t.config.sizeError&&t.config.sizeError());this.config.action}}}dropHandle(t){c.emit(this.quill.id,0);const e=this;t.preventDefault(),e.config.size&&e.file.size>=1024*e.config.size*1024?e.config.sizeError&&e.config.sizeError():(e.file=t.dataTransfer.files[0],this.config.action?e.uploadImg():e.toBase64())}toBase64(){const t=this,e=new FileReader;e.onload=e=>{t.imgURL=e.target.result,t.insertImg()},e.readAsDataURL(t.file)}uploadImg(){const t=this;t.quillLoading;let e=t.config,s=new FormData;s.append(e.name,t.file),e.editForm&&e.editForm(s);let i=new XMLHttpRequest;i.open("post",e.action,!0),e.headers&&e.headers(i),e.change&&e.change(i,s),i.onreadystatechange=function(){if(4===i.readyState)if(200===i.status){let s=JSON.parse(i.responseText);t.imgURL=e.response(s),c.active.uploadSuccess(),t.insertImg(),t.config.success&&t.config.success()}else t.config.error&&t.config.error(),c.active.uploadError()},i.upload.onloadstart=function(t){c.active.uploading(),e.start&&e.start()},i.upload.onprogress=function(t){let e=(t.loaded/t.total*100|0)+"%";c.active.progress(e)},i.upload.onerror=function(t){c.active.uploadError(),e.error&&e.error()},i.upload.onloadend=function(t){e.end&&e.end()},i.send(s)}insertImg(){const t=c.active;t.quill.insertEmbed(c.active.cursorIndex,"image",t.imgURL),t.quill.update(),t.quill.setSelection(t.cursorIndex+1)}progress(t){t="[uploading"+t+"]",c.active.quill.root.innerHTML=c.active.quill.root.innerHTML.replace(/\[uploading.*?\]/,t)}uploading(){let t=(c.active.quill.getSelection()||{}).index||c.active.quill.getLength();c.active.cursorIndex=t,c.active.quill.insertText(c.active.cursorIndex,"[uploading...]",{color:"red"},!0)}uploadError(){c.active.quill.root.innerHTML=c.active.quill.root.innerHTML.replace(/\[uploading.*?\]/,"[upload error]")}uploadSuccess(){c.active.quill.root.innerHTML=c.active.quill.root.innerHTML.replace(/\[uploading.*?\]/,"")}}function l(){let t=document.querySelector(".quill-image-input");null===t&&(t=document.createElement("input"),t.setAttribute("type","file"),t.classList.add("quill-image-input"),t.style.display="none",t.addEventListener("change",(function(){let e=c.active;e.file=t.files[0],t.value="",e.config.size&&e.file.size>=1024*e.config.size*1024?e.config.sizeError&&e.config.sizeError():e.config.action?e.uploadImg():e.toBase64()})),document.body.appendChild(t)),t.click()}var u=s("0bb4");o["Quill"].register("modules/ImageExtend",r);var d={name:"richText",components:{quillEditor:o["quillEditor"]},props:["content"],data:function(){var t=this;return{radio:"0",imgId:[],userId:"",queryOption:"",show_manage:!0,show_send:"",status:0,user_image:"",use_name:"",notes:"",create_time:"",msgList:[],sendList:[],menuId:0,desc:"",editorOption:{placeholder:"请输入通知内容",modules:{ImageExtend:{loading:!0,name:"image",size:1,action:"http://192.168.1.143:8000/admin/notice/image/",response:function(e){console.log("返回结果",e),t.imgId.push(e.data.id);var s="http://192.168.1.143:8000"+e.data.image_url;return s},sizeError:function(){},start:function(){},end:function(){},error:function(){},success:function(){console.log("ImageExtend中的success：上传成功")},change:function(t,e){}},toolbar:{container:[["bold","italic","underline","strike"],["blockquote","code-block"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{direction:"rtl"}],[{size:["small",!1,"large","huge"]}],[{header:[1,2,3,4,5,6,!1]}],[{color:[]},{background:[]}],[{font:[]}],[{align:[]}],["image"]],handlers:{image:function(){c.emit(this.quill.id)}}}}}}},methods:{onEditorChange:function(t){console.log(t)},publish:function(){var t=this;-1!==this.desc.search("<img")?this.status=0:this.status=1,console.log(this.desc,this.radio,Object(a["a"])(this.desc)),Object(u["c"])({user:this.userId,name:this.desc,status:this.status,receive_type:this.radio,image:this.imgId}).then((function(e){console.log(e,"success"),t.imgId=[],Object(u["a"])({page:1,size:20,status:3}).then((function(e){console.log(e,"success"),t.sendList=e.data,t.sendList.length>0&&(t.use_name=t.sendList[0].use_name,t.notes=t.sendList[0].notes,t.create_time=t.sendList[0].create_time)})).catch((function(t){return console.log(t,"error")}))})).catch((function(t){return console.log(t,"error")}))},selectButton:function(t){var e=this;0===t?(this.show_send=!1,this.show_manage=!0,Object(u["a"])({status:this.status,page:1,size:20}).then((function(t){console.log(t,"success"),e.msgList=t.data,e.msgList.length>0&&(e.use_name=e.msgList[0].use_name,e.notes=e.msgList[0].notes,e.create_time=e.msgList[0].create_time)})).catch((function(t){return console.log(t,"error")}))):1===t&&(this.show_send=!0,this.show_manage=!1,Object(u["a"])({page:1,size:20,status:3}).then((function(t){console.log(t,"success"),e.sendList=t.data,e.sendList.length>0&&(e.use_name=e.sendList[0].use_name,e.notes=e.sendList[0].notes,e.create_time=e.sendList[0].create_time)})).catch((function(t){return console.log(t,"error")})))},selectMenu:function(t){var e=this;this.menuId=t,this.status=t,Object(u["a"])({status:this.status,page:1,size:20}).then((function(t){console.log(t,"success"),e.msgList=t.data,e.msgList.length>0&&(e.use_name=e.msgList[0].use_name,e.notes=e.msgList[0].notes,e.create_time=e.msgList[0].create_time)})).catch((function(t){return console.log(t,"error")}))},handleSelect:function(t){this.userId=t.id,console.log("item:",t,this.userId)},select:function(t){this.use_name=this.msgList[t].use_name,this.notes=this.msgList[t].notes,this.create_time=this.msgList[t].create_time,console.log(t)},selectSend:function(t){this.use_name=this.sendList[t].use_name,this.notes=this.sendList[t].notes,this.create_time=this.sendList[t].create_time,console.log(t)},onEditorBlur:function(t){console.log(this.content)},querySearchAsync:function(t,e){var s=this,i=[];Object(u["b"])({item:t}).then((function(t){console.log(t,"success"),i=t.data,e(i),s.loading=!1})).catch((function(t){console.log("err",t),s.loading=!1}))}},mounted:function(){var t=this;Object(u["a"])({status:this.status,page:1,size:20}).then((function(e){console.log(e,"success"),t.msgList=e.data,t.msgList.length>0&&(t.use_name=t.msgList[0].use_name,t.notes=t.msgList[0].notes,t.create_time=t.msgList[0].create_time)})).catch((function(t){return console.log(t,"error")}))}},m=d,g=(s("e97c"),s("2877")),_=function(t){t.options.__source="src/views/pages/platform/message/index.vue"},h=_,v=Object(g["a"])(m,i,n,!1,null,"5fe16a55",null);"function"===typeof h&&h(v);e["default"]=v.exports},e5c9:function(t,e,s){t.exports=s.p+"img/return_icon.ea52622a.png"},e97c:function(t,e,s){"use strict";var i=s("ab12"),n=s.n(i);n.a}}]);